<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Mail Jumper</title>
        <link rel="shortcut icon" href="./images/favicon.ico" />
    </head>
    <body>
        <div>
            <script src="https://unpkg.com/@vkid/sdk@<3.0.0/dist-sdk/umd/index.js"></script>
            <script type="text/javascript">
                if ('VKIDSDK' in window) {
                    const VKID = window.VKIDSDK;

                    VKID.Config.init({
                        app: 53445034,
                        redirectUrl: 'https://mail-jumper.ru',
                        responseMode: VKID.ConfigResponseMode.Callback,
                        source: VKID.ConfigSource.LOWCODE,
                        scope: '', // Заполните нужными доступами по необходимости
                    });

                    const floatingOneTap = new VKID.FloatingOneTap();

                    floatingOneTap
                        .render({
                            appName: 'Mail Jumper',
                            showAlternativeLogin: true,
                        })
                        .on(VKID.WidgetEvents.ERROR, vkidOnError)
                        .on(
                            VKID.FloatingOneTapInternalEvents.LOGIN_SUCCESS,
                            function (payload) {
                                const code = payload.code;
                                const deviceId = payload.device_id;

                                VKID.Auth.exchangeCode(code, deviceId)
                                    .then(vkidOnSuccess)
                                    .catch(vkidOnError);
                            }
                        );

                    function vkidOnSuccess(data) {
                        floatingOneTap.close();

                        console.log(data);
                    }

                    function vkidOnError(error) {
                        // Обработка ошибки
                    }
                }
            </script>
        </div>
        <div id="root"></div>
    </body>
</html>
